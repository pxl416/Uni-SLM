# ========= Basic =========
seed: 3407
save_dir: /home/pxl416/PeixiLiu/px_proj/Uni-SLM/checkpoints/finetune

# ========= Datasets selection =========
active_datasets: ["CSL_Daily"]

datasets:
  CSL_Daily:
    # 数据根目录（包含 sentence/ 和 sentence_label/）
    root: /home/pxl416/PeixiLiu/px_proj/px_data/csl-daily-frames-512x512
    sentence_dir: sentence
    sentence_label_dir: sentence_label

    # 为每个 phase 指定独立的分割列表文件（每行一个样本 id 或相对路径）
    split_files:
      train: /home/pxl416/PeixiLiu/px_proj/Uni-SLM/config/sentence_label/split_1_train.txt
      dev:   /home/pxl416/PeixiLiu/px_proj/Uni-SLM/config/sentence_label/split_1_dev.txt
      test:  /home/pxl416/PeixiLiu/px_proj/Uni-SLM/config/sentence_label/split_1_test.txt

    # 时序采样/长度（你的 finetune.py 会读取 temporal.T 或 temporal.max_frames）
    temporal:
      T: 32   # or max_frames: 32

# ========= Encoders & Projection =========
Encoders:
  rgb:
    output_dim: 512
  text:
    output_dim: 384

Pretraining:
  projection_dim: 256

# ========= Training generic =========
Training:
  batch_size: 8
  num_workers: 4
  epochs: 5
  learning_rate_head: 3e-4
  learning_rate_backbone: 5e-5
  grad_clip: 1.0
  max_length: 64  # 兜底，实际上面 temporal.T=32 会被读取并覆盖

# ========= Finetune control =========
Finetune:
  task: translation           # retrieval / recognition / translation
  train_split: dev          # 你日志里就是用 dev 做训练、test 做评估
  eval_split: test
  amp: true                 # 开启混合精度
  freeze: []                # 例: ["rgb","text","proj"]
  weights:                 # 如需加载单独权重可打开
    rgb_path: /home/pxl416/PeixiLiu/px_proj/Uni-SLM/config/checkpoints/pretrain_daily_1022_i3d_epoch30/weights/latest/rgb_encoder.pt
    text_path: /home/pxl416/PeixiLiu/px_proj/Uni-SLM/config/checkpoints/pretrain_daily_1022_i3d_epoch30/weights/latest/text_encoder.pt
    proj_rgb_path: /home/pxl416/PeixiLiu/px_proj/Uni-SLM/config/checkpoints/pretrain_daily_1022_i3d_epoch30/weights/latest/proj_rgb.pt
    proj_text_path: /home/pxl416/PeixiLiu/px_proj/Uni-SLM/config/checkpoints/pretrain_daily_1022_i3d_epoch30/weights/latest/proj_text.pt


# ========= Evaluation heads config (dims需与你模型一致) =========
Evaluation:
  retrieval:
    rgb_in: 512
    text_in: 384
    proj_dim: 256
    temperature: 0.07
  recognition:
    in_dim: 512
    num_classes: 2000
    hidden_dim: 512
    num_layers: 2
    dropout: 0.1
    blank_id: 0
  translation:
    in_dim: 512
    mt5_path: google/mt5-base
    hidden_dim: 768
    label_smoothing: 0.1
    lang: zh
    max_length: 128

# ========= W&B (可选) =========
wandb:
  use: true
  project: uni-slm-finetune
  run_name: csl-daily-retrieval-split1-1026
